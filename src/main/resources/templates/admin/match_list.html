<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel administratora - KickBet</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>
<body class="admin-page">
<div th:replace="fragments/header :: navbar"></div>

<div class="container mt-4">
    <div class="page-header">
        <div class="d-flex justify-content-between align-items-center">
            <h1><i class="bi bi-gear-fill"></i> Panel administratora</h1>
            <a th:href="@{/admin/matches/new}" class="btn btn-primary btn-lg">
                <i class="bi bi-plus-circle"></i> Dodaj mecz
            </a>
        </div>
    </div>

    <div class="table-container">
        <div class="table-responsive">
            <table class="table table-hover mb-0">
                <thead>
                <tr>
                    <th scope="col"><i class="bi bi-house-door"></i> Gospodarze</th>
                    <th scope="col"><i class="bi bi-airplane"></i> Goście</th>
                    <th scope="col"><i class="bi bi-calendar-event"></i> Data rozpoczęcia</th>
                    <th scope="col"><i class="bi bi-trophy"></i> Wynik</th>
                    <th scope="col" class="text-end"><i class="bi bi-gear"></i> Akcje</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="match : ${matches}">
                    <td><strong th:text="${match.homeTeam}">-</strong></td>
                    <td><strong th:text="${match.awayTeam}">-</strong></td>
                    <td>
                        <i class="bi bi-clock"></i>
                        <span th:text="${#temporals.format(match.startTime, 'dd.MM.yyyy HH:mm')}">-</span>
                    </td>
                    <td>
                        <span th:if="${match.finalResult == null}" class="badge bg-warning text-dark">
                            <i class="bi bi-hourglass-split"></i> Brak
                        </span>
                        <span th:if="${match.finalResult == T(com.mt.KickBet.model.dao.Result).HOME}" class="badge bg-success">
                            <i class="bi bi-check-circle"></i> HOME
                        </span>
                        <span th:if="${match.finalResult == T(com.mt.KickBet.model.dao.Result).DRAW}" class="badge bg-info text-white">
                            <i class="bi bi-dash-circle"></i> REMIS
                        </span>
                        <span th:if="${match.finalResult == T(com.mt.KickBet.model.dao.Result).AWAY}" class="badge bg-danger">
                            <i class="bi bi-x-circle"></i> AWAY
                        </span>
                    </td>
                    <td class="text-end">
                        <div class="btn-group" role="group">
                            <div class="dropdown">
                                <button class="btn btn-sm btn-outline-secondary dropdown-toggle" type="button" data-bs-toggle="dropdown">
                                    <i class="bi bi-flag"></i> Wynik
                                </button>
                                <ul class="dropdown-menu">
                                    <li>
                                        <form th:action="@{/admin/matches/{id}/result(id=${match.id})}" method="post" class="d-inline">
                                            <input type="hidden" name="result" value="HOME">
                                            <button type="submit" class="dropdown-item">
                                                <i class="bi bi-check-circle text-success"></i> HOME
                                            </button>
                                        </form>
                                    </li>
                                    <li>
                                        <form th:action="@{/admin/matches/{id}/result(id=${match.id})}" method="post" class="d-inline">
                                            <input type="hidden" name="result" value="DRAW">
                                            <button type="submit" class="dropdown-item">
                                                <i class="bi bi-dash-circle text-info"></i> REMIS
                                            </button>
                                        </form>
                                    </li>
                                    <li>
                                        <form th:action="@{/admin/matches/{id}/result(id=${match.id})}" method="post" class="d-inline">
                                            <input type="hidden" name="result" value="AWAY">
                                            <button type="submit" class="dropdown-item">
                                                <i class="bi bi-x-circle text-danger"></i> AWAY
                                            </button>
                                        </form>
                                    </li>
                                </ul>
                            </div>
                            <a th:href="@{/admin/matches/{id}/edit(id=${match.id})}" class="btn btn-sm btn-outline-primary">
                                <i class="bi bi-pencil"></i> Edytuj
                            </a>
                            <form th:action="@{/admin/matches/{id}/delete(id=${match.id})}" method="post" class="d-inline" 
                                  th:onclick="return confirm('Czy na pewno chcesz usunąć ten mecz?');">
                                <button type="submit" class="btn btn-sm btn-outline-danger">
                                    <i class="bi bi-trash"></i> Usuń
                                </button>
                            </form>
                        </div>
                    </td>
                </tr>
                <tr th:if="${#lists.isEmpty(matches)}">
                    <td colspan="5" class="text-center text-muted py-5">
                        <i class="bi bi-inbox" style="font-size: 3rem; opacity: 0.3;"></i>
                        <p class="mt-3 mb-0">Brak meczów. Kliknij "Dodaj mecz" aby rozpocząć.</p>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>
</div>

<footer class="bg-light text-center py-4 mt-5">
    <div class="container">
        <p class="mb-0">&copy; 2024 KickBet. Wszystkie prawa zastrzeżone.</p>
    </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
<script>
    document.querySelectorAll('form[action*="/delete"]').forEach(form => {
        form.addEventListener('submit', function(e) {
            if (!confirm('Czy na pewno chcesz usunąć ten mecz?')) {
                e.preventDefault();
            }
        });
    });
</script>
</body>
</html>
